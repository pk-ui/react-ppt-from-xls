{"ast":null,"code":"const BaseXform = require('../base-xform');\n\nclass WorkbookViewXform extends BaseXform {\n  render(xmlStream, model) {\n    const attributes = {\n      xWindow: model.x || 0,\n      yWindow: model.y || 0,\n      windowWidth: model.width || 12000,\n      windowHeight: model.height || 24000,\n      firstSheet: model.firstSheet,\n      activeTab: model.activeTab\n    };\n\n    if (model.visibility && model.visibility !== 'visible') {\n      attributes.visibility = model.visibility;\n    }\n\n    xmlStream.leafNode('workbookView', attributes);\n  }\n\n  parseOpen(node) {\n    if (node.name === 'workbookView') {\n      const model = this.model = {};\n\n      const addS = function (name, value, dflt) {\n        const s = value !== undefined ? model[name] = value : dflt;\n\n        if (s !== undefined) {\n          model[name] = s;\n        }\n      };\n\n      const addN = function (name, value, dflt) {\n        const n = value !== undefined ? model[name] = parseInt(value, 10) : dflt;\n\n        if (n !== undefined) {\n          model[name] = n;\n        }\n      };\n\n      addN('x', node.attributes.xWindow, 0);\n      addN('y', node.attributes.yWindow, 0);\n      addN('width', node.attributes.windowWidth, 25000);\n      addN('height', node.attributes.windowHeight, 10000);\n      addS('visibility', node.attributes.visibility, 'visible');\n      addN('activeTab', node.attributes.activeTab, undefined);\n      addN('firstSheet', node.attributes.firstSheet, undefined);\n      return true;\n    }\n\n    return false;\n  }\n\n  parseText() {}\n\n  parseClose() {\n    return false;\n  }\n\n}\n\nmodule.exports = WorkbookViewXform;","map":null,"metadata":{},"sourceType":"script"}