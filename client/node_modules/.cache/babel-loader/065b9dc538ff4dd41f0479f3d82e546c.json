{"ast":null,"code":"const BaseXform = require('../base-xform');\n/** https://en.wikipedia.org/wiki/Office_Open_XML_file_formats#DrawingML */\n\n\nconst EMU_PER_PIXEL_AT_96_DPI = 9525;\n\nclass ExtXform extends BaseXform {\n  constructor(options) {\n    super();\n    this.tag = options.tag;\n    this.map = {};\n  }\n\n  render(xmlStream, model) {\n    xmlStream.openNode(this.tag);\n    const width = Math.floor(model.width * EMU_PER_PIXEL_AT_96_DPI);\n    const height = Math.floor(model.height * EMU_PER_PIXEL_AT_96_DPI);\n    xmlStream.addAttribute('cx', width);\n    xmlStream.addAttribute('cy', height);\n    xmlStream.closeNode();\n  }\n\n  parseOpen(node) {\n    if (node.name === this.tag) {\n      this.model = {\n        width: parseInt(node.attributes.cx || '0', 10) / EMU_PER_PIXEL_AT_96_DPI,\n        height: parseInt(node.attributes.cy || '0', 10) / EMU_PER_PIXEL_AT_96_DPI\n      };\n      return true;\n    }\n\n    return false;\n  }\n\n  parseText()\n  /* text */\n  {}\n\n  parseClose()\n  /* name */\n  {\n    return false;\n  }\n\n}\n\nmodule.exports = ExtXform;","map":null,"metadata":{},"sourceType":"script"}