{"ast":null,"code":"'use strict';\n\nconst colCache = require('./col-cache'); // const cellRefRegex = /(([a-z_\\-0-9]*)!)?[$]?([a-z]+)[$]?([1-9][0-9]*)/i;\n\n\nconst replacementCandidateRx = /(([a-z_\\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi;\nconst CRrx = /^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;\n\nfunction slideFormula(formula, fromCell, toCell) {\n  const offset = colCache.decode(fromCell);\n  const to = colCache.decode(toCell);\n  return formula.replace(replacementCandidateRx, (refMatch, sheet, sheetMaybe, addrPart, trailingParen) => {\n    if (trailingParen) {\n      return refMatch;\n    }\n\n    const match = CRrx.exec(addrPart);\n\n    if (match) {\n      const colDollar = match[1];\n      const colStr = match[2].toUpperCase();\n      const rowDollar = match[3];\n      const rowStr = match[4];\n\n      if (colStr.length > 3 || colStr.length === 3 && colStr > 'XFD') {\n        // > XFD is the highest col number in excel 2007 and beyond, so this is a named range\n        return refMatch;\n      }\n\n      let col = colCache.l2n(colStr);\n      let row = parseInt(rowStr, 10);\n\n      if (!colDollar) {\n        col += to.col - offset.col;\n      }\n\n      if (!rowDollar) {\n        row += to.row - offset.row;\n      }\n\n      const res = (sheet || '') + (colDollar || '') + colCache.n2l(col) + (rowDollar || '') + row;\n      return res;\n    }\n\n    return refMatch;\n  });\n}\n\nmodule.exports = {\n  slideFormula\n};","map":null,"metadata":{},"sourceType":"script"}